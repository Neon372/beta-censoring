<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.36">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Performance | Beta Censoring</title><meta name="description" content="On-demand censoring of NSFW images just for betas">
    <link rel="modulepreload" href="/beta-censoring/assets/app.be8f0201.js"><link rel="modulepreload" href="/beta-censoring/assets/performance.html.3aafba05.js"><link rel="modulepreload" href="/beta-censoring/assets/performance.html.e0ce529b.js"><link rel="modulepreload" href="/beta-censoring/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/beta-censoring/assets/style.8a7954ba.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/beta-censoring/" class=""><img class="logo" src="/beta-censoring/siteIcon.png" alt="Beta Censoring"><span class="site-name can-hide">Beta Censoring</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/beta-censoring/" class="" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="User Guide"><span class="title">User Guide</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="User Guide"><span class="title">User Guide</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/beta-censoring/content/installation.html" class="" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/beta-censoring/content/usage.html" class="" aria-label="Usage"><!--[--><!--]--> Usage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/beta-censoring/content/configuration.html" class="" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/beta-censoring/content/performance.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Performance"><!--[--><!--]--> Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/beta-censoring/content/beta-safety.html" class="" aria-label="Beta Censoring and Beta Safety"><!--[--><!--]--> Beta Censoring and Beta Safety <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/beta-censoring/content/developers" class="" aria-label="Developers"><!--[--><!--]--> Developers <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/silveredgold/beta-censoring" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/beta-censoring/" class="" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="User Guide"><span class="title">User Guide</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="User Guide"><span class="title">User Guide</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/beta-censoring/content/installation.html" class="" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/beta-censoring/content/usage.html" class="" aria-label="Usage"><!--[--><!--]--> Usage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/beta-censoring/content/configuration.html" class="" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/beta-censoring/content/performance.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Performance"><!--[--><!--]--> Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/beta-censoring/content/beta-safety.html" class="" aria-label="Beta Censoring and Beta Safety"><!--[--><!--]--> Beta Censoring and Beta Safety <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/beta-censoring/content/developers" class="" aria-label="Developers"><!--[--><!--]--> Developers <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/silveredgold/beta-censoring" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Performance <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/beta-censoring/content/performance.html#server-performance" class="router-link-active router-link-exact-active sidebar-item" aria-label="Server Performance"><!--[--><!--]--> Server Performance <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/beta-censoring/content/performance.html#checking-server-performance" class="router-link-active router-link-exact-active sidebar-item" aria-label="Checking Server Performance"><!--[--><!--]--> Checking Server Performance <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/beta-censoring/content/performance.html#performance-impact-guide" class="router-link-active router-link-exact-active sidebar-item" aria-label="Performance Impact Guide"><!--[--><!--]--> Performance Impact Guide <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/beta-censoring/content/performance.html#workers" class="router-link-active router-link-exact-active sidebar-item" aria-label="Workers"><!--[--><!--]--> Workers <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/beta-censoring/content/performance.html#censor-types" class="router-link-active router-link-exact-active sidebar-item" aria-label="Censor Types"><!--[--><!--]--> Censor Types <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/beta-censoring/content/performance.html#image-size" class="router-link-active router-link-exact-active sidebar-item" aria-label="Image Size"><!--[--><!--]--> Image Size <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/beta-censoring/content/performance.html#caching" class="router-link-active router-link-exact-active sidebar-item" aria-label="Caching"><!--[--><!--]--> Caching <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/beta-censoring/content/performance.html#experimental-features" class="router-link-active router-link-exact-active sidebar-item" aria-label="Experimental Features"><!--[--><!--]--> Experimental Features <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><blockquote><p>Note that in the preview releases, configuring the server is an advanced process that assumes some familiarity with editing configuration files yourself. This process will hopefully improve in future releases so it is only recommended to proceed if you are comfortable with that, and really need to.</p></blockquote><h2 id="server-performance" tabindex="-1"><a class="header-anchor" href="#server-performance" aria-hidden="true">#</a> Server Performance</h2><p>Performance for something as complex as Beta Censoring is not an easy topic to discuss, but this will hopefully serve as a reasonably approachable description of where the real performance impacts in Beta Censoring are, and what you can do to improve performance for either real-time or batch/sequential censoring.</p><h3 id="checking-server-performance" tabindex="-1"><a class="header-anchor" href="#checking-server-performance" aria-hidden="true">#</a> Checking Server Performance</h3><p>The Beta Censoring server includes a basic web dashboard to give a rough idea of the performance of the server. To check it, just open your browser and navigate to <a href="http://beta-censoring.local:2382/" target="_blank" rel="noopener noreferrer"><code>http://beta-censoring.local:2382/</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and you should see a simple status panel to check the details of your server. Click the Performance tab to view a quick summary of performance metrics.</p><blockquote><p>If that URL doesn&#39;t work, try directly navigating to the server URL. For example, that would be <a href="http://localhost:2382" target="_blank" rel="noopener noreferrer"><code>http://localhost:2382</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> on the PC you&#39;re running the server on.</p></blockquote><p>This page will give you a <strong>very</strong> rough breakdown of the performance metrics for recent requests for the current server session. Of particular note it will give you some indicators for <em>censoring time</em> and <em>inference time</em>.</p><p><em>Inference time</em> refers to the time it takes for the server to load a requested image, convert it for the AI to handle and actually run it through the AI. This just includes the steps required to load the image and for the AI to classify the matches in the image.</p><p><em>Censoring time</em> refers to the time required to actually censor the results returned by the AI. This includes transforming the results (where necessary) and applying the invididual censoring effects as requested. Given the number of steps involved in this part, this time is currently returned as a single time for the whole censoring step.</p><h2 id="performance-impact-guide" tabindex="-1"><a class="header-anchor" href="#performance-impact-guide" aria-hidden="true">#</a> Performance Impact Guide</h2><h3 id="workers" tabindex="-1"><a class="header-anchor" href="#workers" aria-hidden="true">#</a> Workers</h3><p>As covered in the <a href="/beta-censoring/content/configuration.html" class="">Configuration</a> guide, you can control how many workers the server uses to censor images using the configuration files. Make sure you read that document in full as there are real risks and tradeoffs involved in increasing the default worker count.</p><h3 id="censor-types" tabindex="-1"><a class="header-anchor" href="#censor-types" aria-hidden="true">#</a> Censor Types</h3><p>Beta Censoring makes any of the censor types in CensorCore available for clients to request, which includes (at least) <code>Blur</code>, <code>BlackBar</code>, <code>Caption</code>, <code>Pixelation</code> and <code>Sticker</code>. That being said, some of these are more intensive than others to actually apply to an image. In particular, black bar will generally be the fastest while stickers will generally be the slowest with most of the others between those two. In particular, if you&#39;re noticing the <em>censoring time</em> increasing but not the <em>inference time</em> then you may want to consider using less intensive censoring types.</p><p>Additionally, obfuscation is applied last and to the whole image so it can have a noticeable performance impact, especially on high-resolution images. If you&#39;re using obfuscation, try turning it off and see if that improves response times.</p><h3 id="image-size" tabindex="-1"><a class="header-anchor" href="#image-size" aria-hidden="true">#</a> Image Size</h3><p>As you&#39;d expect, the larger an image the harder it is to both detect matches and censor those matches. Beta Censoring will always scale large images down for the AI (to improve performance) but will then apply censoring to the full-size image and return the censored images at full resolution. This improves quality but does slow the server down when censoring very large images.</p><p>If you&#39;re seeing significant performance degradation with large images, raise an issue on GitHub and we will look into methods to improve this.</p><h3 id="caching" tabindex="-1"><a class="header-anchor" href="#caching" aria-hidden="true">#</a> Caching</h3><p>If caching is enabled, this will noticeably speed up censoring when the same image might be requested multiple times, but at the cost of memory usage. The AI/results cache will speed things up if you&#39;re seeing slowdowns from the AI inference section of a request and will have a smaller effect on memory usage. Conversely, enabling the censoring cache will noticeably speed up the censoring part of a request, but will noticeably increase memory usage in kind.</p><p>Check the <a href="./configuration#caching-configuration">configuration guide</a> for details on enabling/disabling the caches.</p><h3 id="experimental-features" tabindex="-1"><a class="header-anchor" href="#experimental-features" aria-hidden="true">#</a> Experimental Features</h3><p>Some of the features exposed by Beta Censoring are <em>experimental</em> features that we have included for those who want to use them but may impact performance.</p><h4 id="optimization-mode" tabindex="-1"><a class="header-anchor" href="#optimization-mode" aria-hidden="true">#</a> Optimization mode</h4><p>As covered in the <a href="/beta-censoring/content/configuration.html" class="">Configuration guide</a>, Beta Censoring supports different optimization modes. As of the time of writing, this largely controls whether requested images are pre-processed by a body detection model to isolate only the parts of the image that contain people to be censored. This (ab)uses the <a href="https://github.com/PeterL1n/RobustVideoMatting" target="_blank" rel="noopener noreferrer">Robust Video Matting<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> project&#39;s model to try and reduce the amount of work the vastly slower NudeNet model has to do.</p><h4 id="facial-feature-detection" tabindex="-1"><a class="header-anchor" href="#facial-feature-detection" aria-hidden="true">#</a> Facial Feature Detection</h4><p>Facial feature detection uses its own model and middleware to identify specific facial features when faces are detected. Note that facial feature detection will only be run when clients specifically request <code>EYES_F</code> or <code>MOUTH_F</code> censoring in the request. Including these will enable feature detection which can noticeably increase censoring time.</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/silveredgold/beta-censoring/edit/main/docs/content/performance.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 35001040+silveredgold@users.noreply.github.com">Silvered Gold</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/beta-censoring/assets/app.be8f0201.js" defer></script>
  </body>
</html>
